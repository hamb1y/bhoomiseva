---
import ThemeSwitcher from "./ThemeSwitcher.astro"
import Button from "./Button.astro"
---
<header class="site-header">
  <input type="checkbox" id="menu-toggle" class="nav-toggle" aria-hidden="true" />

  <label for="menu-toggle" class="hamburger" aria-label="Toggle navigation">&#9776;</label>

  <img src="/images/BhoomiSeva-LogoCore.webp" alt="Logo light" height="80px" class="logo-light" />
  <img src="/images/BhoomiSeva-LogoCore.webp" alt="Logo dark" height="80px" class="logo-dark" />

  <nav class="navbar" aria-hidden="false">
    <ul>
      <li><a href="/">Home</a></li>
      <li><a href="/blogs">About Us</a></li>
      <li class="dropdown">
        <a
          href="/editable/faq"
          class="dropdown-trigger"
          aria-haspopup="true"
          aria-expanded="false"
        >
          FAQ
        </a>
        <ul class="dropdown-menu" aria-label="FAQ submenu">
          <li><a href="/editable/faq">FAQ Home</a></li>
          <li><a href="/editable/faq#paq">PAQ</a></li>
        </ul>
      </li>
      <li><a href="/contact">Contact Us</a></li>
      <li class="dropdown">
        <a
          class="dropdown-trigger"
          aria-haspopup="true"
          aria-expanded="false"
        >
          Environment
        </a>
        <ul class="dropdown-menu" aria-label="Environment submenu">
          <li><a href="/environment/desi-cow-donation">Desi Cow Donation</a></li>
          <li><a href="/environment/farmer-assistance">Farmer Assistance/Training</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <a
          class="dropdown-trigger"
          aria-haspopup="true"
          aria-expanded="false"
        >
          Education
        </a>
        <ul class="dropdown-menu" aria-label="Education submenu">
          <li><a href="/education/scholarships">Scholarships</a></li>
          <li><a href="/education/orphanage-support">Orphanage Support</a></li>
          <li><a href="/education/online-coaching">Free Online Coaching/Tuition</a></li>
        </ul>
      </li>
      <li><a href="/get-involved">Get Involved</a></li>
      <li><a href="/donate">Donate</a></li>
      <li><a href="/admin/">Admin Login</a></li>
      <li><ThemeSwitcher /></li>

    </ul>
  </nav>

  
</header>

<script is:inline>
  (() => {
    const dropdowns = Array.from(document.querySelectorAll('.navbar .dropdown'));
    if (!dropdowns.length) return;

    const desktopQuery = window.matchMedia('(min-width: 821px)');

    const closeDropdown = (dropdown) => {
      dropdown.classList.remove('is-open');
      const trigger = dropdown.querySelector('.dropdown-trigger');
      if (trigger) {
        trigger.setAttribute('aria-expanded', 'false');
      }
    };

    const openDropdown = (dropdown) => {
      dropdown.classList.add('is-open');
      const trigger = dropdown.querySelector('.dropdown-trigger');
      if (trigger) {
        trigger.setAttribute('aria-expanded', 'true');
      }
    };

    const closeAll = (exception) => {
      dropdowns.forEach((dropdown) => {
        if (dropdown !== exception) {
          closeDropdown(dropdown);
        }
      });
    };

    dropdowns.forEach((dropdown) => {
      const trigger = dropdown.querySelector('.dropdown-trigger');
      if (!trigger) return;

      trigger.addEventListener('click', (event) => {
        const isDesktop = desktopQuery.matches;
        const isOpen = dropdown.classList.contains('is-open');

        if (isDesktop) {
          if (!isOpen) {
            event.preventDefault();
            closeAll(dropdown);
            openDropdown(dropdown);
          }
          return;
        }

        event.preventDefault();
        if (isOpen) {
          closeDropdown(dropdown);
        } else {
          closeAll(dropdown);
          openDropdown(dropdown);
        }
      });

      trigger.addEventListener('keydown', (event) => {
        if (event.key === 'Escape') {
          event.preventDefault();
          closeDropdown(dropdown);
          trigger.focus();
        }
      });
    });

    document.addEventListener('click', (event) => {
      const target = event.target;
      dropdowns.forEach((dropdown) => {
        if (!dropdown.contains(target)) {
          closeDropdown(dropdown);
        }
      });
    });

    desktopQuery.addEventListener('change', () => {
      if (!desktopQuery.matches) {
        closeAll();
      }
    });

    const navToggle = document.querySelector('.nav-toggle');
    if (navToggle) {
      navToggle.addEventListener('change', () => {
        if (!navToggle.checked) {
          closeAll();
        }
      });
    }
  })();
</script>
